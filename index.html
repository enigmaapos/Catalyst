<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Catalyst Protocol Transparency Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background:#111; color:#eee; margin:0; padding:20px; }
    h1,h2,h3 { color:#f0b90b; }
    .panel { background:#1c1c1c; padding:20px; margin-bottom:20px; border-radius:10px; }
    button { background:#f0b90b; border:none; padding:10px 15px; border-radius:5px; cursor:pointer; font-weight:bold; }
    button:hover { opacity:0.85; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th,td { border:1px solid #333; padding:8px; text-align:left; }
    .highlight { font-weight:bold; color:#0ff; }
  </style>
</head>
<body>
  <h1>üî• Catalyst Transparency Dashboard</h1>
  <p>Immutable 90/9/1 Fee Model ‚Ä¢ Real-Time Protocol Health</p>

  <!-- Wallet -->
  <div class="panel">
    <h2>My Wallet</h2>
    <button onclick="connectWallet()">Connect Wallet</button>
    <p id="walletAddr">Not connected</p>
    <p>My Burned CATA: <span class="highlight" id="myBurned">0</span></p>
    <p>My Staked NFTs: <span class="highlight" id="myStaked">0</span></p>
  </div>

  <!-- Protocol Transparency -->
  <div class="panel">
    <h2>Protocol Transparency</h2>
    <p>Immutable Fee Distribution: <br>
      üî• Burn <span class="highlight">90%</span> ‚Ä¢ üè¶ Treasury <span class="highlight">9%</span> ‚Ä¢ üë§ Owner <span class="highlight">1%</span>
    </p>
    <p>Total Burned CATA: <span class="highlight" id="totalBurned">0</span></p>
    <p>Total Staked NFTs: <span class="highlight" id="totalStaked">0</span></p>
    <p>Treasury Balance: <span class="highlight" id="treasuryBal">0</span></p>
    <p>Treasury Bonus Cap: <span class="highlight" id="treasuryCap">0</span>%</p>
    <p>Deployer (Owner) Address: <span class="highlight" id="ownerAddr">0x...</span></p>
  </div>

  <!-- Collections -->
  <div class="panel">
    <h2>Registered Collections</h2>
    <table id="collectionsTable">
      <tr><th>Collection</th><th>Verified?</th><th>Staked</th><th>Burned</th></tr>
    </table>
  </div>

  <!-- Governance -->
  <div class="panel">
    <h2>Governance Proposals</h2>
    <table id="proposalTable">
      <tr><th>ID</th><th>Title</th><th>For</th><th>Against</th><th>Status</th></tr>
    </table>
  </div>

<script>
let provider, signer, contract;
const contractAddress = "YOUR_CONTRACT_ADDRESS";
const contractABI = [ /* Catalyst ABI here */ ];

async function connectWallet(){
  if(window.ethereum){
    provider = new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts", []);
    signer = provider.getSigner();
    contract = new ethers.Contract(contractAddress, contractABI, signer);
    const addr = await signer.getAddress();
    document.getElementById("walletAddr").innerText = addr;
    document.getElementById("ownerAddr").innerText = await contract.deployerAddress();
    refreshData();
  } else { alert("Please install MetaMask!"); }
}

async function refreshData(){
  if(!contract) return;
  // Global stats
  document.getElementById("totalStaked").innerText = (await contract.totalStakedNFTsCount()).toString();
  document.getElementById("totalBurned").innerText = (await contract.totalBurnedCATA()).toString();

  // Treasury
  const tAddr = await contract.treasuryAddress();
  const bal = await contract.cataToken().then(token => {
    let tokenC = new ethers.Contract(token, ["function balanceOf(address) view returns(uint256)"], provider);
    return tokenC.balanceOf(tAddr);
  });
  document.getElementById("treasuryBal").innerText = bal.toString();
  document.getElementById("treasuryCap").innerText = (await contract.treasuryBonusCapBP()).toString()/100;

  // User stats
  const user = await signer.getAddress();
  document.getElementById("myBurned").innerText = (await contract.getBurnedByAddress(user)).toString();
  let totalStaked = 0;
  const cols = await contract.getRegisteredCollections();
  for(let addr of cols){
    let tokens = await contract.getUserStakedTokens(addr, user);
    totalStaked += tokens.length;
  }
  document.getElementById("myStaked").innerText = totalStaked;

  // Collections table
  let html = "<tr><th>Collection</th><th>Verified?</th><th>Staked</th><th>Burned</th></tr>";
  for(let addr of cols){
    let cfg = await contract.getCollectionConfig(addr);
    html += `<tr><td>${addr}</td><td>${cfg.verified?"‚úÖ":"‚ùå"}</td><td>${cfg.stakedCount}</td><td>${cfg.totalBurned}</td></tr>`;
  }
  document.getElementById("collectionsTable").innerHTML = html;

  // Proposals
  let rows = "<tr><th>ID</th><th>Title</th><th>For</th><th>Against</th><th>Status</th></tr>";
  let count = await contract.proposalCount();
  for(let i=0;i<count;i++){
    let p = await contract.proposals(i);
    rows += `<tr><td>${i}</td><td>${p.title}</td><td>${p.votesFor}</td><td>${p.votesAgainst}</td><td>${p.executed?"Executed":"Active"}</td></tr>`;
  }
  document.getElementById("proposalTable").innerHTML = rows;
}

setInterval(refreshData, 30000);
</script>
</body>
</html>
