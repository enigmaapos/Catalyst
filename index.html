<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Catalyst Protocol DApp</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.6.2/dist/ethers.min.js"></script>
  <style>
    .tab { display: none; }
    .tab.active { display: block; }
  </style>
</head>
<body class="bg-gray-100 text-gray-900">
  <div class="container mx-auto p-6">
    <h1 class="text-3xl font-bold mb-6">üåê Catalyst Protocol DApp</h1>
    
    <!-- Navigation Tabs -->
    <div class="flex space-x-4 mb-6">
      <button class="tab-btn bg-blue-500 text-white px-4 py-2 rounded" data-tab="dashboard">Dashboard</button>
      <button class="tab-btn bg-blue-500 text-white px-4 py-2 rounded" data-tab="staking">Staking</button>
      <button class="tab-btn bg-blue-500 text-white px-4 py-2 rounded" data-tab="bluechip">Blue-chip</button>
      <button class="tab-btn bg-blue-500 text-white px-4 py-2 rounded" data-tab="governance">Governance</button>
      <button class="tab-btn bg-blue-500 text-white px-4 py-2 rounded" data-tab="guardians">Guardians</button>
      <button class="tab-btn bg-blue-500 text-white px-4 py-2 rounded" data-tab="admin">Admin</button>
    </div>

    <!-- Tabs -->
    <div id="dashboard" class="tab active">
      <h2 class="text-2xl font-semibold mb-4">üìä Dashboard</h2>
      <button id="btnStats" class="bg-green-500 px-4 py-2 rounded text-white">View Staking Stats</button>
      <pre id="statsView" class="bg-gray-800 text-white p-3 mt-3 rounded"></pre>

      <button id="btnCollections" class="bg-green-500 px-4 py-2 rounded text-white mt-4">View Collections</button>
      <pre id="collectionsView" class="bg-gray-800 text-white p-3 mt-3 rounded"></pre>

      <button id="btnGuardians" class="bg-green-500 px-4 py-2 rounded text-white mt-4">View Guardians</button>
      <pre id="guardiansView" class="bg-gray-800 text-white p-3 mt-3 rounded"></pre>
    </div>

    <div id="staking" class="tab">
      <h2 class="text-2xl font-semibold mb-4">üîí NFT Staking</h2>
      <input id="colStake" placeholder="Collection address" class="border p-2 w-full mb-2"/>
      <input id="tidStake" placeholder="Token ID" class="border p-2 w-full mb-2"/>
      <label><input type="checkbox" id="permanentStake"/> Permanent</label>
      <button id="btnStake" class="bg-blue-600 px-4 py-2 rounded text-white mt-2">Stake NFT</button>

      <h3 class="mt-6 text-xl font-semibold">Batch Stake</h3>
      <input id="colBatchStake" placeholder="Collection address" class="border p-2 w-full mb-2"/>
      <input id="tidsBatchStake" placeholder="Token IDs (comma separated)" class="border p-2 w-full mb-2"/>
      <label><input type="checkbox" id="permanentBatch"/> Permanent</label>
      <button id="btnBatchStake" class="bg-blue-600 px-4 py-2 rounded text-white mt-2">Batch Stake</button>

      <h3 class="mt-6 text-xl font-semibold">Harvest & Unstake</h3>
      <input id="colHarvest" placeholder="Collection address" class="border p-2 w-full mb-2"/>
      <input id="tidHarvest" placeholder="Token ID" class="border p-2 w-full mb-2"/>
      <button id="btnHarvestOne" class="bg-green-600 px-4 py-2 rounded text-white mt-2">Harvest</button>
      <button id="btnUnstake" class="bg-red-600 px-4 py-2 rounded text-white mt-2">Unstake</button>
    </div>

    <div id="bluechip" class="tab">
      <h2 class="text-2xl font-semibold mb-4">üíé Blue-chip</h2>
      <button id="btnEnrollBluechip" class="bg-blue-600 px-4 py-2 rounded text-white">Enroll Wallet</button>

      <h3 class="mt-6 text-xl font-semibold">Harvest Blue-chip Rewards</h3>
      <input id="colBluechip" placeholder="Collection address" class="border p-2 w-full mb-2"/>
      <button id="btnHarvestBluechip" class="bg-green-600 px-4 py-2 rounded text-white">Harvest Bluechip</button>

      <h3 class="mt-6 text-xl font-semibold">Admin: Flag Collection</h3>
      <input id="colFlag" placeholder="Collection address" class="border p-2 w-full mb-2"/>
      <select id="isBluechipFlag" class="border p-2 w-full mb-2">
        <option value="true">True</option>
        <option value="false">False</option>
      </select>
      <button id="btnSetBluechip" class="bg-purple-600 px-4 py-2 rounded text-white">Set Bluechip Collection</button>
    </div>

    <div id="governance" class="tab">
      <h2 class="text-2xl font-semibold mb-4">üó≥Ô∏è Governance</h2>
      <select id="proposalType" class="border p-2 w-full mb-2">
        <option value="0">BASE_REWARD</option>
        <option value="1">HARVEST_FEE</option>
        <option value="2">UNSTAKE_FEE</option>
        <option value="3">REGISTRATION_FEE_FALLBACK</option>
        <option value="4">VOTING_PARAM</option>
        <option value="5">TIER_UPGRADE</option>
      </select>
      <input id="paramTarget" placeholder="Param Target (if needed)" class="border p-2 w-full mb-2"/>
      <input id="newValue" placeholder="New Value" class="border p-2 w-full mb-2"/>
      <input id="collectionContext" placeholder="Collection Context (if any)" class="border p-2 w-full mb-2"/>
      <button id="btnPropose" class="bg-blue-600 px-4 py-2 rounded text-white">Propose</button>

      <h3 class="mt-6 text-xl font-semibold">Vote & Execute</h3>
      <input id="proposalId" placeholder="Proposal ID" class="border p-2 w-full mb-2"/>
      <button id="btnVote" class="bg-green-600 px-4 py-2 rounded text-white">Vote</button>
      <button id="btnExecuteProposal" class="bg-red-600 px-4 py-2 rounded text-white">Execute Proposal</button>
    </div>

    <div id="guardians" class="tab">
      <h2 class="text-2xl font-semibold mb-4">üõ°Ô∏è Guardians</h2>
      <h3 class="text-xl">Set Guardian</h3>
      <input id="guardianIdx" placeholder="Guardian Index" class="border p-2 w-full mb-2"/>
      <input id="guardianAddr" placeholder="Guardian Address" class="border p-2 w-full mb-2"/>
      <button id="btnSetDeployerGuardian" class="bg-purple-600 px-4 py-2 rounded text-white">Set Deployer Guardian</button>
      <button id="btnSetAdminGuardian" class="bg-purple-600 px-4 py-2 rounded text-white">Set Admin Guardian</button>

      <h3 class="mt-6 text-xl">Recovery</h3>
      <input id="newDeployer" placeholder="New Deployer" class="border p-2 w-full mb-2"/>
      <button id="btnProposeDeployerRecovery" class="bg-blue-600 px-4 py-2 rounded text-white">Propose Deployer Recovery</button>
      <button id="btnApproveDeployerRecovery" class="bg-green-600 px-4 py-2 rounded text-white">Approve Deployer Recovery</button>
      <button id="btnExecuteDeployerRecovery" class="bg-red-600 px-4 py-2 rounded text-white">Execute Deployer Recovery</button>

      <input id="newAdmin" placeholder="New Admin" class="border p-2 w-full mb-2 mt-6"/>
      <button id="btnProposeAdminRecovery" class="bg-blue-600 px-4 py-2 rounded text-white">Propose Admin Recovery</button>
      <button id="btnApproveAdminRecovery" class="bg-green-600 px-4 py-2 rounded text-white">Approve Admin Recovery</button>
      <button id="btnExecuteAdminRecovery" class="bg-red-600 px-4 py-2 rounded text-white">Execute Admin Recovery</button>
    </div>

    <div id="admin" class="tab">
      <h2 class="text-2xl font-semibold mb-4">‚öôÔ∏è Admin</h2>
      <h3>Treasury</h3>
      <input id="treasuryTo" placeholder="Recipient address" class="border p-2 w-full mb-2"/>
      <input id="treasuryAmt" placeholder="Amount" class="border p-2 w-full mb-2"/>
      <button id="btnWithdrawTreasury" class="bg-red-600 px-4 py-2 rounded text-white">Withdraw Treasury</button>

      <h3 class="mt-6">Pause / Unpause</h3>
      <button id="btnPause" class="bg-yellow-600 px-4 py-2 rounded text-white">Pause</button>
      <button id="btnUnpause" class="bg-green-600 px-4 py-2 rounded text-white">Unpause</button>
    </div>
  </div>

  <script>
    /* -------------------
       Tab Navigation
    ------------------- */
    document.querySelectorAll('.tab-btn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        document.getElementById(btn.dataset.tab).classList.add('active');
      });
    });

    /* -------------------
       Ethers.js Setup
    ------------------- */
    let provider, signer, CONTRACT, CONTRACT_ADDRESS, ABI;

    async function init() {
      provider = new ethers.BrowserProvider(window.ethereum);
      signer = await provider.getSigner();

      const res = await fetch("abi/CatalystNFTStakingUpgradeable.json");
      ABI = await res.json();

      CONTRACT_ADDRESS = "YOUR_DEPLOYED_CONTRACT"; // TODO: replace
      CONTRACT = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);
    }

    function log(msg) { console.log(msg); }

    window.onload = init;
  </script>
</body>
</html>
